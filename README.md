一、项目介绍
在工作和实习当中，大多数老板使用Office系列的办公软件，每天需要花很多的时间在报表制作、统计分析数据上，大量的人力每天做着重复的工作，工作的效益不高。就拿衍生品交易部门来说，每天交易员要处理大量的台账数据，常常忙的焦头烂额。我们这个项目旨在为衍生品交易部门提供一套用python实现的excel自动化方案，使得交易员能够腾出手来专注于交易本身。

二、项目使用场景
项目主要分为三大块，分别对应于三个不同的使用场景。
第一块内容是用python实现excel的宏功能，用于自动生成部门需要的监管报表。衍生品交易部门每个月需要向证监会提交一次监管报表。每次快到月底的时候，交易员需要处理大量的台账数据，用Excel手动统计去计算监管报表中的每一个项目，非常的耗时耗力。但在使用python的情况下，我们能够按一下按钮3秒钟就完成对监管报表的统计。
第二块内容是用python实现excel的自定义函数功能。我们制作了欧式看涨看跌期权以及雪球期权的定价模板并用python设计了相对应的函数，只要在Excel标注的地方输入想要的参数就可以完成对衍生品的定价，非常的方便和快捷。而且，自定义函数可以批量使用，计算出价差波动率曲面，更加方便交易员去观察波动率和价差对期权价格的影响。
第三块内容是用python实现Excel与数据库的交互。在实际的工作中，交易员经常需要对交易所交易出来的隐含波动率进行研究。通过调用wind函数可以很容易的得到实时变化的隐含波动率曲面，这时候就衍生出来一个新的需求，需要将每秒的波动率曲面的截面记录下来存到数据库中。这些被记录的数据可以用来做一些时序的分析。我们通过Python实现这个需求，将Excel与Mongodb数据库联系在了一起。

三、项目使用说明
在我们所有的解决方案中均用到了xlwings包，用户使用的时候需要在命令行输入-pip install xlwings来安装该第三方包。
此外需要在excel中做一些配置。第一步是要将excel文件保存为宏文件，第二步在excel的代码窗口将xlwings.bas文件添加到引用中去。这时候会看见工具栏上多了一个xlwings的选项，选择该选项，将Python解释器的路径填写到左上角Interpreter中。
对于监管报表的项目，完成这届步骤之后，你就能点击按钮实现一键操作猛如虎啦！
对于波动率曲面的项目，您可能需要下载mongodb数据库，并且在python中安装pymongo的第三方库，安装方法为在命令行输入-pip install pymongo即可。为了方便查看数据库存取情况，还可以下载一个数据库的GUI。我们使用的是robo3t的软件。全部安装完成后打开excel，点击自动计算（这里会用到wind的插件），并运行python脚本，即可将实时变动的波动率曲面存入相应的数据库当中。
对于用户自定义函数的项目，我们需要选到Excel工具栏xlwings选项卡，在UDF modules中填入定义的Python函数，点击import Functions即可完成导入。

                                                                
